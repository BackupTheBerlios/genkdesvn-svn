--- configure.in.in.orig	2005-09-25 20:56:59.507656250 +0200
+++ configure.in.in	2005-09-25 21:00:19.256139750 +0200
@@ -48,17 +48,27 @@
 AC_HEADER_STDC
 AC_CHECK_HEADERS(sys/param.h sys/mman.h sys/time.h sysent.h strings.h sys/stat.h sys/select.h paths.h malloc.h limits.h sys/soundcard.h dlfcn.h termios.h)
 
-USE_POSIX_ACL="yes"
+AC_ARG_WITH(acl,
+  [AC_HELP_STRING(--with-acl,
+    [enable support for POSIX ACLs @<:@default=check@:>@])],
+  [], with_acl=check)
+
 ACL_LIBS=""
-KDE_CHECK_HEADER(attr/libattr.h, ,[USE_POSIX_ACL="no"])
-KDE_CHECK_HEADER(sys/xattr.h, ,[USE_POSIX_ACL="no"])
-KDE_CHECK_HEADER(sys/acl.h, ,[USE_POSIX_ACL="no"])
-KDE_CHECK_HEADER(acl/libacl.h, ,[USE_POSIX_ACL="no"])
-KDE_CHECK_LIB(acl,acl_init, ,[USE_POSIX_ACL="no"])
+if test "x$with_acl" != xno; then
+  USE_POSIX_ACL="yes"
+  KDE_CHECK_HEADER(sys/xattr.h, ,[USE_POSIX_ACL="no"])
+  KDE_CHECK_HEADER(sys/acl.h, ,[USE_POSIX_ACL="no"])
+  KDE_CHECK_HEADER(acl/libacl.h, ,[USE_POSIX_ACL="no"])
+  KDE_CHECK_LIB(acl,acl_init, ,[USE_POSIX_ACL="no"])
 
-if test $USE_POSIX_ACL = "yes" ; then
+  if test $USE_POSIX_ACL = "yes" ; then
     ACL_LIBS="-lacl -lattr"
     AC_DEFINE([USE_POSIX_ACL], 1, [Define if system has POSIX ACL support.])
+  fi
+
+  if test "x$with_acl" != xcheck && test "$USE_POSIX_ACL" != "yes"; then
+    AC_MSG_ERROR([--with-acl was given, but test for POSIX ACLs failed])
+  fi
 fi
 AC_SUBST(ACL_LIBS)
 
